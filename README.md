# LCT Dendrology Telegram Bot

## Описание проекта
LCT Dendrology — это телеграм-бот для дендрологических исследований, который принимает изображения с деревьями, анализирует их с помощью нейросети и возвращает результат:
- Таблица с найденными объектами (Excel)
- Изображение с нанесёнными bbox и идентификаторами объектов
- Текстовый отчет

Бот доступен по адресу: [https://t.me/batchnorm_dendrology_bot](https://t.me/batchnorm_dendrology_bot)

# Структура проекта

Проект состоит из двух основных частей:

- **Сервер (FastAPI)** — принимает изображения, проводит обработку нейросетевыми моделями и возвращает результаты анализа.
- **Бот (Telegram)** — интерфейс для пользователя, через который отправляются изображения и получаются результаты.

Такое разделение позволяет легко расширять проект:
- Подключать другие интерфейсы (например, веб-приложение, мобильное приложение)
- Добавлять новые сервисы (например, базу данных)

## Установка и запуск через Docker

1. Скачайте необходимые модели:
   ```bash
   bash scripts/download_models.sh
   ```

2. Получите токен для Telegram-бота:
   - Перейдите в Telegram и найдите @BotFather
   - Введите команду `/newbot` и следуйте инструкциям
   - Скопируйте выданный токен


3. Создайте файл `.env` с токеном:
   ```bash
   echo "TELEGRAM_BOT_TOKEN=<YOUR_BOT_TOKEN>" > .env
   ```

4. Запустите контейнеры:
   ```bash
   docker compose up --build
   ```

## Что работает после запуска

- FastAPI сервер доступен на порту `8888` (локально):
  - Документация API: [http://localhost:8888/docs](http://localhost:8888/docs)
- Telegram-бот начинает принимать изображения и возвращать результаты анализа
  - Бот: [https://t.me/batchnorm_dendrology_bot](https://t.me/batchnorm_dendrology_bot)

## Конфигурация
Все настройки управляются через `.env` и переменные окружения. Полный список параметров — в `lct_dendrology/cfg/settings.py`.

## Тестирование
Для запуска юнит-тестов:
```bash
poetry run python -m pytest tests/unit_tests/ -v
```



